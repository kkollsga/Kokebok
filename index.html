<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Mine Oppskrifter - Hjemmelaget og Koselig</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .font-display {
            font-family: 'Playfair Display', serif;
        }
        .recipe-card {
            transition: all 0.3s ease;
        }
        .recipe-card:hover {
            transform: translateY(-4px);
        }
        .star {
            transition: all 0.2s ease;
        }
        .star:hover {
            transform: scale(1.2);
        }
        button svg {
            transition: transform 0.2s ease;
        }
        button:active svg {
            transform: scale(0.9);
        }
        /* Filter animations */
        #filterPillsContainer {
            transition: max-width 0.3s ease-out, opacity 0.3s ease-out;
            white-space: nowrap;
            overflow: hidden;
        }
        .filter-pill {
            max-width: 150px;
            display: inline-flex !important;
        }
        .filter-pill-text {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 120px;
        }
        #filterToggle {
            transition: all 0.2s ease;
        }
        #clearFilters {
            transition: opacity 0.2s ease;
        }
        /* Checkbox styling */
        input[type="checkbox"] {
            cursor: pointer;
        }
        input[type="checkbox"]:checked {
            background-color: rgb(217 119 6);
            border-color: rgb(217 119 6);
        }
        /* Custom scrollbar for recipe sections */
        .recipe-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .recipe-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        .recipe-scroll::-webkit-scrollbar-thumb {
            background: #d4d4d4;
            border-radius: 3px;
        }
        .recipe-scroll::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* Body lock when modal is open */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
        }
        /* Mobile modal styles with Safari support */
        @supports (height: 100dvh) {
            .modal-height-mobile {
                height: 100dvh !important;
            }
        }
        @supports not (height: 100dvh) {
            .modal-height-mobile {
                height: 100vh !important;
                height: -webkit-fill-available !important;
            }
        }
        /* Mobile modal specific styles */
        @media (max-width: 640px) {
            #recipeModal {
                padding: 0 !important;
            }
            .modal-content-mobile {
                height: 100vh;
                height: 100dvh;
                height: -webkit-fill-available;
                width: 100vw !important;
                max-width: 100vw !important;
                border-radius: 0 !important;
                margin: 0 !important;
                position: relative;
                overflow: hidden;
            }
            .modal-image-container-fixed {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: 224px; /* h-56 = 14rem = 224px */
                z-index: 10;
                overflow: hidden;
            }
            .modal-content-scrollable {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                z-index: 5;
            }
            .modal-content-spacer {
                height: 224px; /* Same as image container */
                pointer-events: none;
            }
            .modal-content-body {
                background: white;
                min-height: calc(100vh - 224px);
                padding-bottom: calc(env(safe-area-inset-bottom, 20px) + 40px);
            }
        }
        /* Modern input focus styles */
        .modern-input:focus {
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
        }
        /* Filter menu shadow */
        .filter-menu-shadow {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        /* Safe area padding for iOS */
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom, 0);
        }
        .safe-top {
            padding-top: env(safe-area-inset-top, 0);
        }
        /* Category badge hover effect */
        .category-badge {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .category-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        /* Tip styling */
        .recipe-tip {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 3px solid #f59e0b;
            animation: tipHighlight 0.3s ease-out;
        }
        @keyframes tipHighlight {
            from {
                transform: translateX(-10px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        /* Text clamping for description */
        .description-clamp {
            overflow: hidden;
            display: -webkit-box;        /* required for old WebKit */
            -webkit-box-orient: vertical;
            line-clamp: 2;
            -webkit-line-clamp: 2;
            text-overflow: ellipsis;     /* optional */
        }


        /* Eraser button animation */
        .eraser-btn {
            transition: all 0.2s ease;
            opacity: 0;
            transform: translateX(10px);
            pointer-events: none;
        }
        .eraser-btn.show {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
        }
        /* Desktop modal scroll-over-image effect */
        .modal-image-fixed {
            position: sticky;
            top: 0;
            z-index: 0;
        }
        .modal-content-overlay {
            position: relative;
            z-index: 1;
            background: white;
            margin-top: -20px;
            border-top-left-radius: 1.5rem;
            border-top-right-radius: 1.5rem;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 via-amber-50 to-yellow-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white/90 backdrop-blur-sm shadow-sm sticky top-0 z-40 safe-top">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-between items-center">
                <h1 class="font-display text-3xl text-amber-800">Mine Oppskrifter</h1>
            </div>
        </div>
    </header>

    <!-- Search Bar -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8">
        <div class="bg-white/95 backdrop-blur rounded-2xl shadow-lg border border-white/50 p-1.5">
            <div class="relative">
                <svg class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <input type="text" id="searchInput" placeholder="Søk etter oppskrifter eller ingredienser..." 
                       class="modern-input w-full pl-12 pr-4 py-3 bg-gray-50/50 border-0 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-400 focus:bg-white transition-all text-gray-700 placeholder-gray-400">
            </div>
        </div>
    </div>

    <!-- Filter Bar -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
        <div class="bg-white/95 backdrop-blur rounded-2xl shadow-lg border border-white/50 p-4">
            <div class="flex items-center gap-3">
                <!-- Filter Button -->
                <button id="filterToggle" onclick="toggleFilterMenu()" 
                        class="flex items-center space-x-2 px-4 py-2 rounded-xl transition-all text-sm font-medium shrink-0 shadow-sm hover:shadow-md">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                    </svg>
                    <span>Filter</span>
                    <span id="filterCount" class="hidden bg-white/30 text-white text-xs px-1.5 py-0.5 rounded-full font-semibold">0</span>
                </button>
                
                <!-- Filter Pills Container -->
                <div id="filterPillsContainer" class="flex gap-2 flex-1 overflow-hidden">
                    <!-- Filter pills will be inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Clear Filters Button (moved below) -->
        <div class="flex justify-end mt-2">
            <button id="clearFilters" onclick="clearAllFilters()" 
                    class="text-xs text-gray-500 hover:text-amber-600 transition-all opacity-0 pointer-events-none font-medium px-3 py-1 rounded-lg hover:bg-white/80">
                Tøm filter
            </button>
        </div>
        
        <!-- Filter Dropdown Menu -->
        <div id="filterMenu" class="relative">
            <div class="absolute top-2 left-0 bg-white rounded-xl filter-menu-shadow border border-gray-100 p-4 z-30 hidden min-w-[280px]">
                <div class="text-sm font-semibold text-gray-700 mb-3">Velg kategorier</div>
                <div id="filterOptions" class="space-y-1 max-h-96 overflow-y-auto">
                    <!-- Filter options will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Recommendations Section -->
    <div id="recommendationsSection" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6">
        <div id="recommendations" class="mb-8">
            <h2 class="font-display text-2xl text-amber-800 mb-4">Anbefalte for deg</h2>
            <div id="recommendedRecipes" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Recommended recipes will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Main Recipe Grid -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8 pb-12 safe-bottom">
        <h2 class="font-display text-2xl text-amber-800 mb-4">Alle Oppskrifter</h2>
        <div id="recipeGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Recipe cards will be inserted here -->
        </div>
    </div>

    <!-- Recipe Modal -->
    <div id="recipeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-start justify-center min-h-screen sm:pt-8">
            <div class="bg-white sm:rounded-2xl max-w-5xl w-full sm:h-[92vh] modal-height-mobile flex flex-col overflow-hidden modal-content-mobile">
                <div id="modalContent" class="h-full flex flex-col">
                    <!-- Recipe content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Image path configuration
        const IMAGE_PATH_LIST = 'images/full/';
        const IMAGE_PATH_MODAL = 'images/full/';
        
        // Filter state
        let activeFilters = new Map();
        let filterMenuOpen = false;
        let searchQuery = '';
        let scrollPosition = 0;
        
        // Recipe database - NOW AS AN ARRAY
        const recipeDatabase = [
            {"id":"recipe_1755485212305_6c4rynvqc","title":"Berlinerkranser","servings":"Ca. 30–40 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":3,"category":"Julekaker","meal":"Snacks","cuisine":"Norsk","description":"Berlinerkranser er en klassisk norsk julekake laget av en smør- og eggeplommerik deig. De formes til små kranser, pensles med eggehvite, dyppes i sukker og stekes til de er lett gylne. De har en sprø, søt overflate og en smørmør kjerne – en fast tradisjon på norske kakefat i julen.","image":"berlinerkranser.png","ingredients":["250 g hvetemel","65 g sukker","145 g margarin eller smør","1 eggeplomme","1 eggehvite (til pensling)","perlesukker eller grovt sukker (til topping)"],"instructions":["Smuldre sammen hvetemel, sukker og margarin til en smuldrete blanding.","Tilsett eggeplommen og kna deigen godt sammen til en smidig deig.","Del deigen i små emner og trill ut til fingertykke pølser.","Form små kranser og legg på et bakepapirkledd stekebrett.","Pensle kransene med lett pisket eggehvite.","Dypp oversiden i perlesukker eller grovt sukker.","Stek ved svak varme, ca. 175 °C, i 8–10 minutter til de er lett gylne.","Avkjøl på rist og oppbevar i tett kakeboks."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755540531697_0ukql48af","title":"Smultringer","servings":"Ca. 40–50 smultringer","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":4,"category":"Småkaker","meal":"Snacks","cuisine":"Norsk","description":"Tradisjonelle norske smultringer stekt i smult eller matfett. De har en mild smak av sitron og krydder, med en gyllen, sprø overflate. Klassiske til jul, men også perfekte som kaffekos året rundt.","image":"smultringer.png","ingredients":["2 egg","3 kopper sukker (ca. 6 dl)","4 kopper helmelk (ca. 8 dl)","50 g smør, smeltet","3 ts hornsalt (hjortetakksalt)","1 ts natron","½ ts sitrondråper eller revet sitronskall","Ca. 1–1,2 kg hvetemel (til en fast, men smidig deig)","Smult eller matfett til steking"],"instructions":["Pisk egg og sukker til det er lyst og luftig.","Tilsett melk, smeltet smør og sitrondråper (eller revet skall).","Bland inn siktet hvetemel, hornsalt og natron litt etter litt, til deigen blir fast men smidig.","Kjevle ut deigen til ca. ½ cm tykk leiv.","Stikk ut smultringer med en smultringutstikker eller bruk et glass og en liten kork til midten.","Varm smult eller matfett i en gryte til ca. 170 °C.","Stek smultringene gyllenbrune på begge sider.","La dem renne av på kjøkkenpapir før servering."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755475274682_pg1vg0qjn","title":"Kake med mokkakrem","servings":"10-12 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":5,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk, luftig sukkerbrødkake fylt og dekket med en silkemyk mokkakrem. Kaken har en balansert smak av kaffe og kakao, og passer perfekt til kaffeselskap, bursdag eller fest. Kan også varieres med syltetøy mellom lagene for ekstra friskhet.","image":"kakemedmokkakrem.png","ingredients":[{"group":"Sukkerbrød","items":["6 egg","180 g sukker (ca. 2 dl)","180 g hvetemel (ca. 3 dl)","1 ts bakepulver (valgfritt, gir ekstra sikkerhet)"]},{"group":"Mokkakrem","items":["150 g smør, romtemperert","100 g melis (ca. 1,5 dl)","3 ss sterk kaffe, avkjølt","2 ss kakao","1 ts vaniljedråper eller 1 ts vaniljesukker"]}],"instructions":["Sett ovnen på 160–170 °C (over- og undervarme). Smør en rundform (24 cm) og legg bakepapir i bunnen.","Visp egg og sukker til lys og luftig eggedosis (5–10 minutter).","Sikt mel og bakepulver over eggedosisen, og vend det forsiktig inn med en slikkepott.","Hell røren i formen og stek på nederste rille i ca. 30–40 minutter, til sukkerbrødet er gyllent og en kakepinne kommer ut ren. Avkjøl helt på rist.","Når sukkerbrødet er avkjølt, del det i to eller tre lag.","Lag mokkakremen: Pisk smør og melis hvitt og luftig (5–7 minutter). Tilsett kaffe, kakao og vanilje litt etter litt. Pisk til en jevn og smørbar krem.","Legg en kakebunn på fat. Smør på et lag mokkakrem, eller ha syltetøy mellom lagene om ønskelig. Fortsett med neste bunn.","Dekk hele kaken med resten av mokkakremen på toppen og langs sidene.","Pynt gjerne med mokkabønner, sjokoladespon eller et lett dryss kakao.","La kaken stå kjølig i minst 1 time før servering for at smakene skal sette seg."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755523615872_c8ydauis7","title":"Sjokoladekake med vaniljeglasur","servings":"10–12 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":6,"category":"Kake","meal":"Dessert","cuisine":"Skandinavisk","description":"En saftig sjokoladekake med en luftig bunn, fylt og dekket med en smørkrem laget på en base av vaniljekrem. Først kokes en enkel vaniljekrem som må avkjøles, deretter blandes den med smør og melis til en silkemyk smørkrem som både kan brukes som fyll mellom lagene og som glasur på toppen og sidene. Kaken pyntes til slutt med sjokolade, enten raspet som dekor eller smeltet og fordelt over glasuren for en blank finish.","image":"sjokoladekakevaniljeglasur.png","ingredients":[{"group":"Kakebunn","items":["5 egg","150 g sukker","100 g hvetemel","50 g potetmel","25 g kakao","2 ts bakepulver (strøkne)","50 g revet sjokolade"]},{"group":"Glasur (smørkrem)","items":["1 1/2 ss hvetemel","1/2 liter melk","60–80 g sukker","1 egg","1–2 ts vaniljesukker","100 g smør","30–40 g melis"]},{"group":"Pynt","items":["100 g sjokolade (revet som spon eller smeltet til glasur)"]}],"instructions":["Pisk eggeplommene godt og tilsett sukkeret litt etter litt under stadig pisking.","Pisk eggehvitene stive og vend forsiktig inn i eggeplommeblandingen.","Bland hvetemel, potetmel, kakao, bakepulver og revet sjokolade. Sikt det tørre inn i røren og vend forsiktig sammen.","Hell røren i en smurt form (24 cm) og stek ved 175 °C i ca. 30–35 minutter, til kaken er gjennomstekt. Avkjøl helt.","Lag vaniljekrem (base til glasuren): Rør sammen hvetemel, melk og sukker i en kjele. Kok opp under omrøring. Tilsett vaniljesukker og egg, og rør til kremen tykner. Avkjøl helt.","Visp smør og melis hvitt. Rør inn den avkjølte vaniljekremen litt etter litt til en glatt smørkrem.","Del kaken i to eller tre lag. Bruk smørkremen både som fyll mellom lagene og som glasur på toppen og sidene.","Pynt kaken med 100 g sjokolade – enten ved å drysse over revet sjokolade eller ved å smelte sjokoladen og fordele den jevnt over glasuren.","La kaken trekke kjølig i minst 1 time før servering for å sette smakene."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755553770811_i0qwsu6dx","title":"Smørkake","servings":"1 form","provider":"Farmors håndskrevne kokebok","reference":"Farmors oppskrifter","pageNumber":7,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk, luftig smørkake der smør og sukker piskes hvitt for å gi kaken fin konsistens. Passer godt som kaffekake og kan serveres naturell eller med melisdryss.","image":"smorkake.png","ingredients":["3 egg","500 g sukker (ca. 5,5 dl)","65 g smør","1,5 dl melk","4 ts bakepulver","4 ts vaniljesukker"],"instructions":["Pisk smør og sukker hvitt og luftig.","Tilsett eggene ett om gangen og visp godt.","Rør inn melken.","Sikt sammen mel, bakepulver og vaniljesukker og vend det inn til slutt.","Hell røren i en smurt form og stek ved ca. 175 °C i 40–50 minutter til kaken er ferdig."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755524663629_mxj8jiua2","title":"Sjokolade- og mandelkake i langpanne","servings":"Ca. 20–25 ruter","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":9,"category":"Kake","meal":"Dessert","cuisine":"Skandinavisk","description":"En saftig langpannekake laget med sjokolade, sitronskall og hakkede mandler. Smør og sukker piskes hvitt, eggene blandes inn, og til slutt røres sjokolade, mandler og sitronskall inn i røren. Kaken stekes i langpanne og skjæres i firkanter når den er ferdig. Tradisjonelt serveres den uten glasur, men den kan gjerne pyntes med et lett dryss melis for et festligere preg.","image":"sjokoladeogmandelkake.png","ingredients":["250 g smør","250 g sukker","250 g hvetemel","4 egg (plommer og hviter skilles)","100 g mørk sjokolade (smeltet)","revet skall av 1 sitron","50 g hakkede mandler","melis til pynt (valgfritt)"],"instructions":["Visp smør og sukker til det er hvitt og luftig.","Tilsett eggeplommene én etter én under omrøring.","Smelt sjokoladen og rør den inn sammen med revet sitronskall.","Sikt hvetemelet og vend det vekselvis inn med stivpiskede eggehviter.","Vend til slutt inn de hakkede mandlene.","Hell røren i en smurt og bakepapirkledd langpanne.","Stek kaken midt i ovnen ved 175 °C i ca. 30–35 minutter, til den er gjennomstekt.","Avkjøl og skjær i firkanter.","Dryss gjerne melis over kaken før servering."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755525039501_v1gcazw3t","title":"Sjokoladesnitter","servings":"Ca. 30–40 snitter","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":9,"category":"Julekaker","meal":"Snacks","cuisine":"Skandinavisk","description":"Sjokoladesnitter er enkle, klassiske småkaker der en mørdeig smaksatt med kakao formes til lengder, stekes og skjæres i skrå snitter. Kakene blir sprø i kantene og litt seige i midten – en populær småkake til kaffebordet og i julen.","image":"sjokoladesnitter.png","ingredients":["200 g smør","200 g sukker","1 egg","3 ss kakao","250 g hvetemel","2 ts potetmel","2 ts bakepulver","1 ts vaniljesukker"],"instructions":["Visp smør og sukker hvitt og luftig.","Tilsett egget og rør godt inn.","Sikt sammen kakao, hvetemel, potetmel, bakepulver og vaniljesukker.","Rør det tørre inn i smørblandingen og arbeid deigen raskt sammen.","Del deigen i 3–4 deler og rull ut til lengder.","Legg lengdene på bakepapirkledd stekebrett og trykk dem litt flate med en gaffel eller baksiden av en skje.","Stek midt i ovnen ved 175 °C i ca. 12–15 minutter.","Skjær lengdene i skrå snitter mens de fortsatt er varme.","La sjokoladesnittene avkjøles helt på rist og oppbevar i tett kakeboks."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755525313393_x86s8trii","title":"Fru Meyers kaker","servings":"Ca. 40 småkaker","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":10,"category":"Julekaker","meal":"Snacks","cuisine":"Skandinavisk","description":"Fru Meyers kaker er klassiske småkaker laget med en enkel deig av margarin, sukker, potetmel og hvetemel. Kakene er lette og sprø, med en mild smak av sitron. De formes med teskje som små topper på platen og stekes til de er lys-gule. En tradisjonell småkake som passer godt både til kaffekosen og på julekakefatet.","image":"frumeyerskaker.png","ingredients":["125 g margarin","125 g sukker","125 g potetmel","140 g hvetemel","1 egg","3/4 ts hornsalt (hjortetakksalt)","5 dråper sitronessens"],"instructions":["Rør margarin og sukker hvitt.","Pisk egget lett sammen og ha det i.","Sikt på mel og hornsalt og rør godt.","Ha i sitrondråper.","Sett små topper av deigen på platen med en teskje, litt mellomrom imellom.","Stekes lys-gule i svak varme (ca. 160–170 °C) i 8–10 minutter.","Avkjøles på rist og oppbevares i tett kakeboks."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755525787550_591atv6ib","title":"Freia formkake","servings":"8–10 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":11,"category":"Kake","meal":"Dessert","cuisine":"Skandinavisk","description":"Freia formkake er en klassisk, enkel smørkake laget med både hvetemel og potetmel. Resultatet blir en saftig og lett kake med fin struktur. Den passer godt til kaffekos, og kan gjerne serveres naturell eller med et lett dryss melis. Oppskriften stammer trolig fra Freias bakepulverpakke.","image":"freiaformkake.png","ingredients":["125 g smør","125 g sukker","70 g hvetemel","70 g potetmel","2 egg","1/2 ts bakepulver","1 ts vaniljesukker eller revet skall av 1/2 sitron (valgfritt, for smak)","melis til pynt (valgfritt)"],"instructions":["Rør smør og sukker hvitt.","Tilsett eggene, ett om gangen, og visp godt mellom hver.","Bland hvetemel, potetmel og bakepulver sammen, og sikt det i røren.","Vend forsiktig til alt er godt blandet. Tilsett gjerne vaniljesukker eller revet sitronskall for ekstra smak.","Hell røren i en smurt form (ca. 1 liter).","Stek kaken i middels varm ovn (ca. 175 °C) i omtrent 45 minutter, til den er gjennomstekt og gyllen.","Avkjøl på rist før servering.","Dryss gjerne melis over kaken før servering."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755526142808_1e6hjyujv","title":"Brune snipper","servings":"Ca. 40–50 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":12,"category":"Småkaker","meal":"Julekaker","cuisine":"Norsk","description":"Brune snipper er klassiske julekaker laget med sirup, krydder og en klype pepper for ekstra smak. Deigen skal helst hvile til neste dag før utkjevling. Kakene kuttes i diamanter (snipper) og blir sprø og krydrede, perfekt til julens kakefat.","image":"brunesnipper.png","ingredients":["65 g sukker","35 g margarin","125 g sirup","3/4 dl fløte","250 g hvetemel","1/2 ts pepper","1/4 ts ingefær","1/2 ts natron","Ev. halve mandler til pynt"],"instructions":["Ha sukker, sirup og fløte i en kjele og varm opp til margarinen er smeltet. Rør godt sammen.","Avkjøl blandingen litt, og sikt inn alt det tørre (hvetemel, krydder og natron). Elt til en jevn deig.","La deigen hvile til neste dag, gjerne kjølig.","Kjevle ut deigen tynt, ca. 2–3 mm. Skjær ut snipper ved å først skjære lange strimler på skrå (3–4 cm brede), og deretter skjære på skrå den andre veien slik at det dannes små diamanter (ca. 4–5 cm på langsiden).","Legg snippene på smurt plate eller bakepapir. Pynt gjerne med en halv mandel i midten av hver.","Stek kakene i lys gyllen farge ved middels varme (ca. 175 °C) i 8–10 minutter."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755476864587_2erpf8ln7","title":"Wienerbrød","servings":"Ca. 16–20 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":13,"category":"Bakverk","meal":"Dessert","cuisine":"Dansk","description":"Et klassisk dansk wienerbrød laget av en luftig gjærdeig som lamineres med margarin. Kaken kan fylles med forskjellige fyll – mandelmasse, eggekrem eller havregrynsfyll – og toppes med glasur. Resultatet er et luftig og smørfylt bakverk som passer perfekt til kaffebordet.","image":"wienerbrod.png","ingredients":[{"group":"Grunndeig","items":["500 g hvetemel","30 g sukker","50 g margarin (til deigen)","35 g gjær","1/2 ts kardemomme","3 dl melk","1 egg","150 g margarin (til innbaking, lagvis)"]},{"group":"Alternativ 1 – Mandelmassefyll","items":["50 g mandler (malte)","75 g sukker","1/2 eggehvite","3 ss mandeldråper"]},{"group":"Alternativ 2 – Havregrynsfyll","items":["50 g havregryn","75 g sukker","1/2 eggehvite","noen dråper vanilje eller mandelessens"]},{"group":"Alternativ 3 – Eggekremfyll","items":["20 g hvetemel","2 dl melk","1 eggeplomme","20 g sukker"]},{"group":"Melisglasur (valgfritt)","items":["75 g melis","1/2 eggehvite"]}],"instructions":["Lag deigen (Grunndeig): Bland mel og sukker i en bolle. Smuldre inn 50 g margarin.","Rør ut gjæren i lunken melk og tilsett sammen med egg og kardemomme. Elt deigen godt til den er smidig.","La deigen hvile i ca. 15 minutter. Kjevle deretter ut til et rektangel.","Fordel 150 g margarin i tynne skiver/klatter over deigen. Brett sammen og kjevle ut igjen. Gjenta 2–3 ganger for å få lagvis deig. La hvile mellom kjevlingene.","Velg fyll: Forbered ett av alternativene:","Alternativ 1 – Mandelmassefyll: Bland malte mandler, sukker, eggehvite og mandeldråper til en fast masse.","Alternativ 2 – Havregrynsfyll: Bland havregryn, sukker, eggehvite og noen dråper essens til en jevn masse.","Alternativ 3 – Eggekremfyll: Ha mel i en kjele, spe med melk og kok opp under omrøring. Tilsett sukker og eggeplomme. Rør til kremen tykner. Avkjøl.","Montering: Kjevle deigen ut til ca. 0,5 cm tykkelse. Skjær i firkanter, legg litt av valgt fyll i midten og brett hjørnene inn mot midten.","Legg brødene på bakepapirkledd stekebrett, dekk til og etterhev i 30–40 minutter.","Pensle med sammenvispet egg. Stek midt i ovnen ved 200 °C i ca. 10–12 minutter, til de er gyllenbrune.","Avkjøl på rist.","Glasur (Melisglasur, valgfritt): Bland melis og eggehvite til en glatt glasur. Ha den over de avkjølte vinabrødene.","Server nybakte eller oppbevar kjølig. Kan fryses uten glasur."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755477197309_jcux6iyx1","title":"Formkake","servings":"8–10 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":15,"category":"Kake","meal":"Dessert","cuisine":"Skandinavisk","description":"En klassisk formkake med smør, sukker, egg og hvetemel, smaksatt med sitron og fylt med tørket frukt. Kaken blir saftig og aromatisk, perfekt til ettermiddagskaffen eller som en tradisjonell kaffekake. Sukat, som er kandisert sitron- eller appelsinskall, gir kaken en frisk og søt smak. Dersom du ikke finner sukat, kan du bruke kandisert appelsinskall, sitronskall eller erstatte med litt ekstra rosiner.","image":"formkake.png","ingredients":["100 g smør","100 g sukker","2 egg","200 g hvetemel","1 ts bakepulver","50 g korinter","50 g sukat","revet skall av 1/2 sitron eller 5–6 dråper sitronessens"],"instructions":["Visp smør og sukker hvitt og luftig.","Tilsett eggene, ett om gangen, og pisk godt mellom hver.","Sikt inn hvetemel og bakepulver, og vend forsiktig inn i røren.","Tilsett revet sitronskall eller sitrondråper.","Vend inn korinter og sukat til slutt.","Ha røren i en smurt form.","Stek i middels varm ovn (ca. 175–180 °C) i 35–45 minutter, til kaken er gjennomstekt og gyllen. Test med kakepinne.","Avkjøl på rist og server som den er eller med et lett dryss melis."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755483218975_n2vin9hoz","title":"Peppernøtter","servings":"Ca. 40–50 småkaker","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":16,"category":"Julekaker","meal":"Snacks","cuisine":"Skandinavisk","description":"Peppernøtter er små krydrede julekaker som minner om pepperkaker, men de er rundere og litt mykere i konsistensen. De formes til små kuler og stekes til de blir gyllenbrune. Perfekte til adventstiden, julekaffen eller som små munnfuller gjennom hele desember.","image":"peppernotter.png","ingredients":["125 g smør","125 g sukker","ca. 250 g hvetemel","1 dl kremfløte","1 ts kardemomme","1 ts kanel","1/3 ts pepper","1 ts natron","1/2 ts bakepulver"],"instructions":["Visp smør og sukker til det er hvitt og luftig.","Tilsett kremfløten og rør godt sammen.","Sikt hvetemel, kardemomme, kanel, pepper, natron og bakepulver i en bolle.","Vend det tørre inn i smørblandingen og arbeid deigen raskt sammen til en jevn deig.","Trill deigen til små kuler og legg dem på et bakepapirkledd stekebrett.","Stek peppernøttene midt i ovnen ved 175–180 °C i 8–10 minutter, til de er jevnt gyllenbrune.","Avkjøl på rist og oppbevar i en tett kakeboks."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755566518474_3zxd45n9l","title":"Bakepulverstenger","servings":"Ca. 30–40 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":17,"category":"Småkaker","meal":"Kaffemat","cuisine":"Norsk","description":"Bakepulverstenger er enkle og luftige småkaker laget uten gjær. De formes som stenger, pensles med egg og strøs med grovt sukker for en gyllen og sprø overflate. Perfekt til kaffekosen.","image":"bakepulverstenger.png","ingredients":["500 g hvetemel","100 g margarin","100 g sukker","1 egg","2 1/2 dl melk","3 ts bakepulver","1 egg til pensling","Litt grovt sukker til topping"],"instructions":["Bland sammen hvetemel, sukker og bakepulver i en bolle.","Smuldre inn margarinen til det ligner grovt smuler.","Pisk egget lett og rør det inn sammen med melken. Arbeid deigen raskt sammen.","Del deigen i fire emner og trill ut til stenger.","Legg stengene på bakepapirkledd plate, pensle med sammenvispet egg og strø over grovt sukker.","Stek til de er lyse gylne ved ca. 200 °C i 10–12 minutter."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755530008601_5c9sko0oi","title":"Wienerring","servings":"1 stor ring","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":18,"category":"Gjærbakst","meal":"Kake","cuisine":"Skandinavisk","description":"Wienerring er en klassisk gjærbakst fylt med en mild krem basert på fløte, vanilje og eggeplomme. Deigen rulles med fyll, formes til en ring og klippes opp slik at fyllet blir synlig under steking. Resultatet er en luftig og dekorativ festkake som passer perfekt på kaffebordet.","image":"wienerring.png","ingredients":[{"group":"Deig","items":["250 g hvetemel","50 g sukker","ca. 1 ¼ dl melk (lunken)","1 egg","40 g gjær","100 g smør","1 egg til pensling","Litt hakkede mandler til pynt"]},{"group":"Fyll","items":["1 eggeplomme","1 ½ dl fløte","½ ts vaniljesukker","1 ss potetmel","1 ss sukker"]}],"instructions":["Sikt sammen hvetemel og sukker i en bolle.","Løs opp gjæren i lunken melk og pisk inn egget.","Bland væsken i det tørre og elt deigen til den er smidig. Arbeid inn smøret til slutt. La heve til dobbel størrelse.","Lag fyllet: Pisk sammen fløte, eggeplomme, sukker, potetmel og vaniljesukker. Kok forsiktig opp under omrøring til en tykk krem. Avkjøl.","Kjevle deigen ut til et stort rektangel og fordel fyllet jevnt utover.","Rull deigen sammen fra langsiden til en lang pølse og legg den på et stekebrett med bakepapir.","Form pølsen til en stor ring og klem endene godt sammen.","Klipp skrå snitt med ca. 3 cm mellomrom nesten helt igjennom, og vri hvert stykke litt utover så fyllet synes.","Pensle med egg og dryss over hakkede mandler.","Stek ved 180 °C (varmluft) eller 200 °C (over- og undervarme) i ca. 25–30 minutter til den er gyllenbrun."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755554972871_batotnjp9","title":"Kremarhus","servings":"Ca. 12 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":19,"category":"Småkaker","meal":"Dessert","cuisine":"Norsk","description":"Sprø, lette kremarhus laget av eggehviter, smør, sukker og mel. Formes mens de er varme til kjegler og fylles gjerne med krem, bær eller is.","image":"kremarhus.png","ingredients":["120 g smør eller margarin","120 g sukker","120 g hvetemel, siktet","4 eggehviter","½ ts vaniljeekstrakt"],"instructions":["Pisk smør og sukker hvitt og luftig.","Tilsett vanilje og sikt i hvetemelet. Rør forsiktig sammen.","Pisk eggehvitene stive og vend dem forsiktig inn.","Smør røren tynt utover bakepapir eller bruk krumkakejern.","Stek ved 160–170 °C til svakt gylne.","Form straks til kremarhus ved hjelp av kremarhusspiss.","Avkjøl og fyll med krem, bær eller is før servering.","Bør brukes samme dag, eller oppbevares i tett boks for å bevare sprøheten.","Tips: Passer utmerket til dessert med bær og krem."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755556074900_6qxxo2r5w","title":"Gjærkake med rosiner","servings":"1 stor kake (ca. 12–15 snitter)","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":20,"category":"Kake","meal":"Kaffemat","cuisine":"Norsk","description":"En klassisk norsk gjærkake fra 60–80-tallet, med rosiner, et hint av sitron og et deilig sukker- og kanelstrø på toppen. Kaken er myk, luftig og aromatisk, perfekt til kaffebordet eller som helgekos.","image":"gjaerkakemedrosiner.png","ingredients":[{"group":"Deig","items":["500 g hvetemel","100 g sukker","170 g smør eller margarin","½ ts malt kardemomme","1 ts revet sitronskall (eller noen dråper sitronessens)","3,75 dl melk","40 g fersk gjær"]},{"group":"Fyll og topping","items":["80 g rosiner","40 g sukker","1–2 ts malt kanel","2 ss smeltet smør til pensling"]}],"instructions":["Sikt sammen mel, sukker og kardemomme i en stor bakebolle. Smuldre inn smøret.","Varm opp melken til ca. 37 °C og løs gjæren i melken. Hell dette i melblandingen og elt til en smidig deig.","Dekk til og la deigen heve til dobbel størrelse, ca. 45–60 minutter.","Elt inn rosiner (og evt. sukat). Kjevle deigen ut til et rektangel og legg den på et bakepapirkledd stekebrett.","La deigen etterheve i ca. 30 minutter.","Pensle overflaten med smeltet smør. Strø over sukker og kanel i et rutemønster.","Stek midt i ovnen ved 200 °C i 25–30 minutter, til kaken er gyllen og gjennomstekt.","Avkjøl litt, skjær i snitter og server lun eller avkjølt."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755556519322_xc1wy808f","title":"Eplefromasj","servings":"6-8 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":21,"category":"Dessert","meal":"Dessert","cuisine":"Norsk","description":"En klassisk norsk dessert fra 60–80-tallet. Lett, luftig og frisk smak av epler, blandet med krem og gelatin for en stivnet fromasj. Serveres kald, gjerne pyntet med krem og epleskiver. Passer perfekt etter søndagsmiddag, ofte servert med småkaker ved siden av.","image":"eplefromasje.png","ingredients":["1 kg epler (gjerne syrlige)","1 dl vann","200 g sukker (ca. 2 dl)","6 dl kremfløte","6 gelatinplater","0,5 dl kokende vann","Pynt: ekstra pisket krem og skiver av røde epler eller bær"],"instructions":["Skrell og rens eplene. Kok dem møre i vann og sukker, ca. 10–15 minutter.","Mos til glatt eplemos og avkjøl.","Legg gelatinplatene i kaldt vann i 5 minutter.","Smelt gelatinen i 0,5 dl kokende vann og rør til alt er oppløst.","Bland gelatinen inn i den avkjølte eplemosen.","Pisk kremfløten stiv og vend den forsiktig inn i eplemosen.","Fordel i en stor skål eller porsjonsglass og sett kaldt i minst 2–3 timer.","Pynt med ekstra krem og epleskiver eller bær før servering.","Server gjerne med småkaker."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755557799588_dlu14ce9v","title":"Fikenkake","servings":"8 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":22,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En saftig og aromatisk formkake med tørket fiken og hasselnøtter. Kaken har en tett og saftig konsistens, og minner om fruktkake, men er lettere og enklere. Passer godt til kaffe eller som dessert med krem eller vaniljeis.","image":"fikenkake.png","ingredients":["2 egg","100 g sukker","150 g tørkede fiken, finhakket","50 g hasselnøtter, grovhakket","100 g hvetemel","½ ts bakepulver"],"instructions":["Forvarm ovnen til 175 °C (over- og undervarme).","Smør en liten brødform eller springform (ca. 20 cm) og dryss lett med mel eller semulegryn.","Pisk egg og sukker til en lys og luftig eggedosis.","Vend inn finhakkede fiken.","Sikt sammen hvetemel og bakepulver, og vend dette forsiktig inn i røren sammen med hasselnøtter.","Hell røren i den smurte formen.","Stek i ca. 35–40 minutter, til kaken er gyllenbrun og en kakepinne kommer ut ren.","Avkjøl på rist.","TIP: Bløtlegg gjerne fiken i rom eller appelsinjuice for ekstra saftighet."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755557918514_hnluopgqs","title":"Krydderkake","servings":"12 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":23,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En saftig og aromatisk krydderkake med smak av kanel, kardemomme, appelsinskall og mandler. Perfekt til kaffekos eller som hverdagskake. Den holder seg godt noen dager og blir ofte enda bedre dagen etter.","image":"krydderkake.png","ingredients":["2 egg","250 g sukker","160 g smør (smeltet)","1,25 dl syrnet fløte eller lettrømme","1 ts kardemomme","1 ts kanel","1 ss revet eller sukra appelsinskall","20 g hakkede mandler","225 g hvetemel","1 ts bakepulver"],"instructions":["Visp egg og sukker til eggedosis.","Smelt smøret og avkjøl lett.","Rør inn smøret og den syrnede fløten i eggedosisen.","Tilsett kardemomme, kanel, appelsinskall og finhakkede mandler.","Sikt sammen hvetemel og bakepulver, og vend det forsiktig inn i røren.","Smør en brødform (ca. 1,5 liter) og strø med brødrasp eller mel.","Hell røren i formen.","Stek på 175 °C midt i ovnen i ca. 40–50 minutter, til kaken er gyllen og en kakepinne kommer ut ren.","Avkjøl kaken i formen i 10 minutter før den hvelves over på rist.","TIP: Kaken smaker ekstra godt dagen etter, når kryddersmaken har satt seg."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755558008707_dq4xcdrqf","title":"Havregrynsboller","servings":"20 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":24,"category":"Brød","meal":"Frokost","cuisine":"Norsk","description":"Lette og luftige boller laget med havregryn. Litt søte, men fortsatt egnet som frokost- eller matpakkebrød. Best når de spises nystekte – sprø utenpå og myke inni.","image":"havregrynsboller.png","ingredients":["170 g havregryn","3–4 dl melk","300 g hvetemel","½ ts salt","2 ss sukker","50 g smør","6 ts bakepulver"],"instructions":["Kok opp melken og hell den over havregrynene. La blandingen avkjøle.","Sikt hvetemel sammen med bakepulver, og rør inn sukker og salt.","Smuldre inn smøret i melblandingen.","Bland de avkjølte havregrynene med melk inn i det tørre til en smidig, passe fast deig.","Trill ut til små boller og legg dem på stekebrett med bakepapir.","Stek midt i ovnen ved 200 °C i ca. 12–15 minutter, til bollene er gyldne.","TIP: Server bollene samme dag – da er de sprø utenpå og myke inni."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755558421198_xvg1go8ff","title":"Systerkaka","servings":"12-15 porsjoner (2–3 former)","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":25,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk søt gjærkake med rosiner og sukat, typisk for norske kjøkken på 1960–80-tallet. Mild, saftig og aromatisk med kardemomme. Passer godt som kaffekake eller til søndagskos.","image":"systerkake.png","ingredients":["550 g hvetemel","150 g potetmel","125 g sukker","150 g smør","½ ts kardemomme","ca. 4 dl melk (lunken)","1 egg","50 g gjær (eller 1 pose tørrgjær)","70 g rosiner","50 g sukat"],"instructions":["Sikt sammen hvetemel og potetmel i en bolle og smuldre inn smøret.","Tilsett sukker og kardemomme.","Rør gjæren ut i lunken melk.","Pisk egget lett og bland i sammen med melk og gjær.","Elt deigen godt og la heve ca. 1 time.","Elt inn rosiner og sukat.","Fordel deigen i 2–3 smurte former. Etterhev i ca. 30 min.","Stek ved 180 °C i 35–40 min til kaken er gyllen og gjennomstekt.","TIP: Server gjerne med smør eller brunost. Kan fryses."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755558505336_app0buc45","title":"Havregrynsknas","servings":"Ca. 20–25 ruter","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":26,"category":"Småkaker","meal":"Snacks","cuisine":"Norsk","description":"En enkel og sprø havregrynskake som skjæres i ruter. Perfekt som kaffekos eller småkake, lett å lage og typisk for 60–80-tallets norske kjøkken.","image":"havregrynsknas.png","ingredients":["4 dl havregryn","2 dl sukker","200 g smeltet smør","2 dl hvetemel"],"instructions":["Bland havregryn, sukker, smeltet smør og hvetemel godt sammen til en jevn deig.","Smør deigen utover en bakepapirkledd langpanne, ca. 0,5–1 cm tykk.","Stek midt i ovnen ved 180 °C til lys gyllenbrun, ca. 12–15 minutter.","Skjær opp i ruter mens kaken fremdeles er varm.","Avkjøl helt før servering.","TIP: Tilsett gjerne litt vaniljesukker eller hakkede nøtter for ekstra smak."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755558606095_2e6nu8ykg","title":"Frukt og brødfromasj","servings":"6 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":27,"category":"Dessert","meal":"Dessert","cuisine":"Norsk","description":"En luftig fromasj laget med pisket krem, gelatin og en blanding av knust brød eller kjeks. Tradisjonell norsk dessert fra 60–70-tallet, ofte laget med kavringer og syltetøy av bær. Passer godt som dessert etter middag, pyntet med krem og syltetøy.","image":"fruktogbrodfromasj.png","ingredients":["6 dl kremfløte","1 ss vaniljeekstrakt eller vaniljesukker","3 dl knust brød, kavringer eller kjeks (f.eks. digestive)","50 g sukker","15 g gelatin (ca. 2 plater eller 1 pakke pulver)","0,5 dl kokende vann","3 ss syltetøy (bringebær, bjørnebær eller lignende)"],"instructions":["Pisk kremfløten stiv i en bolle.","Ha i vaniljen og bland inn sukkeret.","Vend inn det knuste brødet eller kjeksen sammen med syltetøyet.","Løs opp gelatinen i kokende vann og rør godt til den er helt oppløst.","Vend den oppløste gelatinen inn i fromasjblandingen.","Ha fromasjen i en glassbolle eller fordel i dessertskåler.","Sett kaldt til fromasjen stivner.","TIP: Pynt med litt ekstra pisket krem og en skje syltetøy ved servering."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755558760110_uwrhndrng","title":"Terteringar","servings":"Ca. 40 småkaker","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":28,"category":"Småkaker","meal":"Snacks","cuisine":"Norsk","description":"Små smørkaker i terte-stil, rullet i eggehvite og sukker for en sprø, lett karamellisert overflate. De får en lys gyllen farge og passer godt til kaffe eller som et lite søtt innslag på kakebordet.","image":"terteringer.png","ingredients":["250 g hvetemel","175 g smør (kaldt eller romtemperert)","1 eggeplomme","5 ss kremfløte","1 eggehvite (til pensling)","3–4 ss perlesukker eller grovt sukker (til rulling)"],"instructions":["Sikt melet og smuldre det sammen med smøret til en smuldrete masse.","Tilsett eggeplommen og fløten. Elt raskt sammen til en jevn deig.","Kjevle deigen ut til ca. 0,5 cm tykkelse.","Stikk ut små runde kaker (bruk et glass eller små former).","Dypp hver kake først i lett vispet eggehvite og deretter i grovt sukker.","Legg kakene på en bakepapirkledd stekeplate.","Stek midt i ovnen ved 180 °C i 8–12 minutter, til de er lys gyldne.","Avkjøl på rist og oppbevar i tett boks.","TIP: Bruk perlesukker for ekstra sprø og dekorative kaker."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755558862621_mmrlec5cm","title":"Rugkjeks","servings":"20–25 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":29,"category":"Kjeks","meal":"Snacks","cuisine":"Norsk","description":"Sprø, smakfulle rugkjeks med karve. Passer perfekt til ost, smør eller som en liten snacks. Rugmelet gir nøtteaktig smak og sprøhet.","image":"rugkjeks.png","ingredients":["125 g fint rugmel","125 g hvetemel","180 g smør (kaldt, i terninger)","½ ts karve","1 ss eddik (7%)","0,75 dl kaldt vann"],"instructions":["Sikt melene i en bolle og smuldre inn smøret til blandingen ligner grovt smuldret deig.","Tilsett karve, eddik og kaldt vann. Elt raskt sammen til en jevn deig.","La deigen hvile i kjøleskap i minst 30 minutter.","Kjevle ut deigen tynt på melet bord og prikk overflaten med en gaffel.","Skjær ut firkanter på ca. 8 × 8 cm og legg på bakepapirkledd stekebrett.","Stek midt i ovnen ved 200 °C i 8–12 minutter, til kjeksene er gylne og sprø.","Avkjøl på rist før servering.","TIP: Oppbevar i tett boks. Passer svært godt til ostefat."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755559016550_78flrd1r7","title":"Fylt kjeks","servings":"Ca. 25–30 fylte kjeks","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":30,"category":"Kjeks","meal":"Snacks","cuisine":"Norsk","description":"Sprø, hjemmelagde småkaker fylt med kremet sjokoladefyll eller friskt bringebærfyll. Klassisk kaffekjeks fra 60–70-tallet som smaker ekstra godt når to kjeks legges sammen med fyll. Passer både til kaffebordet og som en liten hverdagskos.","image":"fyltkjeks.png","ingredients":[{"group":"Kjeksdeig","items":["2 små egg","150 g sukker","250 g hvetemel","150 g smør (romtemperert)","1 ts bakepulver"]},{"group":"Fyll (alternativer)","items":["125 g melis rørt med ca. 75 g delfiafett","eller 125 g melis blandet med litt bringebærsaft","eller 125 g melis rørt med kakao og litt vann til en krem"]}],"instructions":["Visp egg og sukker til en lys og luftig eggedosis.","Tilsett mykt smør og siktet mel blandet med bakepulver. Bland alt godt sammen til en jevn deig.","Kjevle deigen tynt ut på melet bord.","Stikk ut små firkantede eller runde kjeks.","Legg kjeksene på bakepapirkledd stekebrett og stek midt i ovnen på 180 °C i ca. 8–10 minutter, til de er lett gylne.","Avkjøl kjeksene helt på rist.","Lag ønsket fyll: rør sammen melis med enten smeltet delfiafett, bringebærsaft, eller kakao og vann, til en smørbar krem.","Smør fyll på undersiden av en kjeks og legg en annen oppå, slik at det blir små sandwich-kjeks.","TIP: Disse kjeksene er best samme dag de fylles, men kan oppbevares i tett boks i 2–3 dager. De uten fyll holder seg sprø i flere uker."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755556429373_md0pmu8kg","title":"Amies kake","servings":"12 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":31,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk norsk sjokoladekake med mild kaffesmak og luftig smørkrem. Passer perfekt til kaffebord, bursdager eller som en hverdagskake. Smørkremen bør brukes samme dag. Tips: For en barnevennlig variant kan kaffen byttes ut med melk.","image":"amieskake.png","ingredients":[{"group":"Kakebunn","items":["2 egg","2 dl sukker","1 dl sterk kaffe","300 g hvetemel","30 g kakao","1 ts bakepulver","200 g smør (smeltet)"]},{"group":"Smørkrem","items":["200 g smør (romtemperert)","125 g melis","1 eggeplomme","noen dråper vaniljeessens"]}],"instructions":["Sett ovnen på 180 °C over- og undervarme og smør eller dekk en liten langpanne (20×30 cm).","Pisk egg og sukker til lys og luftig eggedosis.","Smelt smøret og la det avkjøle litt.","Rør inn kaffen og smøret i eggedosisen.","Sikt sammen hvetemel, kakao og bakepulver og vend det forsiktig inn.","Hell røren i formen og stek midt i ovnen ved 180 °C i ca. 30–35 minutter, til gjennomstekt. Avkjøl kaken.","Pisk smør og melis til hvitt og luftig. Tilsett eggeplommen og vaniljeessens, og pisk til glatt krem.","Smør kremen oppå kaken eller mellom to lag. Server romtemperert."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755559275124_oarukiqz6","title":"En God Fruktkake","servings":"1 kake (ca. 10-12 porsjoner)","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":32,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk norsk fruktkake. Lett og luftig som et sukkerbrød, tilsatt sitron for friskhet. Kan serveres som dessert med krem og frukt eller pyntes til kaffebordet med nøtter og glasur.","image":"fruktkake.png","ingredients":[{"group":"Kakebunn","items":["4 egg","100 g sukker","3 ss kaldt vann","15 g potetmel","95 g hvetemel","1 ½ ts bakepulver","1 ts sitronsaft"]},{"group":"Forslag til fyll","items":["3 dl kremfløte, pisket til krem","2 ss melis (til å søte kremen, valgfritt)","1 ts vaniljesukker (til kremen, valgfritt)","1 boks hermetiske pærer eller fersken i biter","eller 200 g friske bær (jordbær, bringebær eller blåbær)"]}],"instructions":["Pisk egg og sukker til luftig eggedosis.","Tilsett kaldt vann og sitronsaft, rør forsiktig inn.","Sikt sammen hvetemel, potetmel og bakepulver. Vend dette forsiktig inn i røren.","Hell røren i en smurt kakeform (ca. 22–24 cm).","Stek ved 180 °C i ca. 35–40 minutter til kaken er gyllen og gjennomstekt.","Avkjøl på rist.","Del kaken i to lag når den er helt avkjølt.","Fyll med pisket krem og frukt eller bær etter ønske.","Legg på toppen og pynt eventuelt med ekstra krem, bær, glasur, nøtter eller små marengstopper.","TIP: Hermetiske pærer eller fersken gir en klassisk smak fra 60–70-tallet, mens friske bær gjør kaken lettere og friskere."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755559527459_zsk3fc1zv","title":"Syltetøyoppskrifter","servings":"Ca. 4-6 glass per oppskrift","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":33,"category":"Syltetøy","meal":"Frokost","cuisine":"Norsk","description":"En samling av tradisjonelle syltetøyoppskrifter fra 60-80 tallet med solbær, rips, stikkelsbær og plommer. Klassiske bevaringsmetoder der syltetøyene kokes med vann og sukker og tappes på glass.","image":"syltetoy.png","ingredients":[{"group":"Solbærsyltetøy","items":["1 kg solbær","1 liter vann","2 kg sukker"]},{"group":"Ripsbærsyltetøy","items":["2 kg rips","2,5 dl vann","2 kg sukker"]},{"group":"Stikkelsbærsyltetøy","items":["2 kg stikkelsbær","6 dl vann","1,8 kg sukker"]},{"group":"Plommesyltetøy","items":["1 kg plommer","2 dl vann","800 g sukker"]},{"group":"Stikkelsbærsyltetøy (variant)","items":["1 kg stikkelsbær","1 kg sukker","½ liter vann"]}],"instructions":["Solbærsyltetøy: Kok bær og vann i 15 minutter. Tilsett sukker og kok videre i ca. ½ time. Hell på varme glass.","Ripsbærsyltetøy: Kok bær og vann til bærene sprekker. Tilsett sukker og kok videre til passe konsistens. Hell på glass.","Stikkelsbærsyltetøy: Kok bær og vann til de er møre. Tilsett sukker og kok videre til syltetøyet er ferdig. Hell på glass.","Plommesyltetøy: Kok plommer og vann i ½ time. Tilsett sukker og kok videre i ½ time. Ta ut steinene. Hell på glass.","TIP: Til hermetisering brukes 1 kg sukker pr. 16 plommer.","Stikkelsbærsyltetøy (variant): Legg bær og sukker lagvis i en bolle, la stå til neste dag. Kok så med vann i ca. ½ time. Hell på glass."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755559637965_415q43ypc","title":"Sjokoladekake","servings":"1 langpanne (ca. 20–24 stk.)","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":34,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk, saftig sjokoladekake fra 60–70-tallet med smør, sjokolade og fyldig glasur. Perfekt til kaffebord, bursdager eller som en tradisjonell hverdagskake. Glasuren med kaffe gir en fyldig smak som balanserer sødmen.","image":"sjokoladekake.png","ingredients":[{"group":"Kakebunn","items":["150 g smør","3 dl sukker","2 1/2 dl melk","3 ts bakepulver","1/2 plate kokesjokolade (ca. 50 g)","2 egg","3 1/2 dl hvetemel"]},{"group":"Fyll / Glasur","items":["100 g smør","1/2 plate kokesjokolade (ca. 50 g)","2 ts vaniljesukker","3/4 dl sterk kaffe, varm","400 g melis"]}],"instructions":["Sett stekeovnen på 180 °C over- og undervarme.","Smelt smøret til kakebunnen. Rør smør og sukker hvitt.","Tilsett eggene, ett om gangen, og rør godt mellom hvert.","Smelt sjokoladen forsiktig i vannbad eller mikrobølgeovn og bland den i røren.","Rør inn melk og hvetemel blandet med bakepulver, vekselvis, til du får en jevn røre.","Hell røren i en smurt eller bakepapirkledd langpanne (ca. 20x30 cm).","Stek kaken midt i ovnen i ca. 30–35 minutter, til den er gjennomstekt. Avkjøl kaken helt før glasuren has på.","Til glasuren: Smelt smøret og sjokoladen sammen. Rør inn vaniljesukker.","Tilsett kaffe og siktet melis, og pisk til en glatt og smørbar glasur.","Bre glasuren over den avkjølte kaken og la den sette seg før servering.","TIP: Kaken blir ekstra saftig dagen etter. Oppbevares kjølig og tildekket."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755560023988_dskuqphf0","title":"Figurkrem","servings":"30-40 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":35,"category":"Kaker","meal":"Snacks","cuisine":"Norsk","description":"Figurkrem er sprø småkaker laget med egg, sukker, smør, potetmel og fløte. Deigen kjevles ut og trykkes ut i ulike figurer. Kakene har en mild smak med et hint av kanel og romessens, og passer godt til kaffebord eller som småkaker til høytider.","image":"figurkrem.png","ingredients":[{"group":"Deig","items":["2 egg","100 g sukker","200 g smør, romtemperert","100 g potetmel","40 g hvetemel","1 ½ ts bakepulver","2 ss fløte","50 g hvetemel ekstra til justering","½ ts romessens"]}],"instructions":["Pisk egg og sukker til eggedosis.","Tilsett smøret litt av gangen og rør godt.","Sikt sammen potetmel, hvetemel, bakepulver og kanel. Vend dette inn vekselvis med fløten.","Rør inn romessens og arbeid deigen til den blir jevn og smidig.","Pakk deigen i plast og la den hvile i kjøleskapet i ca. 30 minutter.","Kjevle ut deigen til ca. 3–4 mm tykkelse på et melet bakebord.","Stikk ut figurer med pepperkakeformer eller glass.","Legg figurene på stekebrett kledd med bakepapir.","Stek midt i ovnen ved 180 °C i 8–10 minutter, til de er lett gyllenbrune.","Avkjøl på rist.","TIP: Kakene kan oppbevares i tett boks i flere uker, men er sprøest samme dag de er bakt."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755560963597_u6hujnzsj","title":"Aprikosmos","servings":"4 porsjoner","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":36,"category":"Dessert","meal":"Dessert","cuisine":"Norsk","description":"En frisk og søt aprikosmos laget av tørkede aprikoser, søtet med sukker og blandet med krem. Kan brukes som dessert eller kakefyll. Pyntes gjerne med appelsinskiver.","image":"aprikosmos.png","ingredients":["250 g tørkede aprikoser","½ ts salt","3–4 aprikoskjerner (valgfritt)","1–2 dl kremfløte","125 g sukker"],"instructions":["Skyll aprikosene og legg dem i en kjele.","Kok i lettsaltet vann i 15–20 minutter til møre.","Sil av kokevannet (spar litt til justering).","Mos aprikosene fint, gjerne med stavmikser.","Rør inn sukker mens mosen er varm.","Avkjøl helt.","Vend inn lett pisket krem.","Server i dessertskåler og pynt med appelsinskiver.","TIP: Tilsett litt sitronsaft for friskere smak."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755560893492_1fold3rr2","title":"Franske vafler","servings":"Ca. 20–25 små kaker","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":36,"category":"Vafler","meal":"Snacks","cuisine":"Europeisk","description":"Små, sprø vafler fylt med krem eller smørkrem. Sukkerstrødd og festlige, passer perfekt til kaffeselskap.","image":"franskevafler.png","ingredients":["125 g smør (kaldt, i terninger)","1,25 dl kremfløte","125 g sukker","Grovt sukker til dryss","1½ dl krem eller smørkrem til fyll"],"instructions":["Smuldre smør og mel sammen til en kornete masse.","Tilsett fløten og elt raskt til en jevn deig.","Kjevle deigen tynt ut og stikk ut små runde kaker.","Vend hver kake i sukker på den ene siden.","Legg kakene på stekebrett med sukkersiden opp.","Stek ved 190 °C i 7–10 minutter til gyldne.","Avkjøl på rist.","Legg kakene sammen to og to med krem eller smørkrem som fyll.","TIP: Kakene bør fylles samme dag de skal serveres."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755560809737_iki43pv6d","title":"Sigrunns kake","servings":"1 kake (ca. 10–12 porsjoner)","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":36,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk, saftig formkake med potetmel som gir lett konsistens. Passer godt som kaffekake eller dessert, gjerne med bær eller krem.","image":"sigrunnskake.png","ingredients":["300 g smør (romtemperert eller smeltet og avkjølt)","300 g sukker","3 egg","150 g potetmel","160 g hvetemel","1 ts bakepulver"],"instructions":["Pisk smør og sukker hvitt og luftig.","Tilsett eggene, ett om gangen, og pisk godt mellom hvert.","Bland potetmel, hvetemel og bakepulver, og sikt det inn i røren. Vend forsiktig sammen.","Hell røren i en smurt kakeform (ca. 24 cm springform).","Stek på 175 °C i ca. 1 time, til kaken er gyllen og gjennomstekt.","Avkjøl i formen noen minutter før den tas ut.","TIP: Server gjerne med bær og krem eller dryss melis over kaken før servering."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755561053234_vrosyv1oq","title":"Havrekjeks","servings":"Ca. 40–50 kjeks","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":37,"category":"Kjeks","meal":"Snacks","cuisine":"Norsk","description":"Sprø og milde havrekjeks som passer godt til kaffe, på tur eller sammen med ost og syltetøy.","image":"havrekjeks.png","ingredients":["500 g havregryn","500 g margarin eller smør","500 g hvetemel","5 dl melk","150–200 g sukker (juster etter smak)","6 ts bakepulver"],"instructions":["Varm opp melken og smelt margarinen i den.","Bland havregryn og sukker i en stor bolle.","Hell melkeblandingen over og la det stå minst 30 minutter.","Bland hvetemelet med bakepulver og rør det inn i deigen.","Kjevle ut deigen til ca. 3–4 mm tykkelse. Stikk ut runde kjeks med et glass eller skjær ut firkanter.","Legg kjeksene på bakepapirkledd stekebrett.","Stek midt i ovnen ved 200 °C i 8–12 minutter, til de er gyldne.","Avkjøl på rist.","TIP: Kjeksene blir best hvis de ikke lages for tykke. Oppbevares i tett kakeboks."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755561481988_fwwrfd8pn","title":"Majas Kokos-sukkerkake","servings":"1 liten langpanne eller 12–14 kakestykker","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":38,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En saftig og søt kake med kokos. Kaken er holdbar og enkel å lage, passer godt til kaffe eller som dessert med friske bær og krem.","image":"kokossukkerkake.png","ingredients":["3 egg","200 g sukker","100 g smør, smeltet","1 dl kremfløte eller fløtemelk","180 g hvetemel","2 dl kokosmasse","1 ts bakepulver"],"instructions":["Pisk egg og sukker til luftig eggedosis.","Vend inn smeltet smør og fløte.","Bland mel og bakepulver, og sikt det inn i røren.","Tilsett kokosmasse og rør forsiktig sammen.","Hell røren i en smurt og strødd form.","Stek midt i ovnen ved 175 °C i 25–30 minutter.","Avkjøl på rist før servering.","TIP: Kaken holder seg saftig lenge og passer godt til kaffe eller med bær og krem."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755561559921_tq2e55vou","title":"Havremuffins","servings":"Ca. 15–20 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":39,"category":"Kake","meal":"Snacks","cuisine":"Norsk","description":"Saftige havremuffins med sjokoladeglasur. Deigen er enkel å røre sammen og gir luftige muffins med nøtteaktig smak fra havregryn. Glasuren tilfører en rik sjokoladesmak som passer perfekt til kaffe eller som kaffemat.","image":"havremuffins.png","ingredients":[{"group":"Muffinsrøre","items":["2 egg","2 dl sukker","150 g smeltet margarin eller smør","90 g havregryn","180 g hvetemel","1 ts bakepulver","2–3 ss hakkede mandler eller rosiner"]},{"group":"Glasur","items":["120 g melis","1 ½ ss kakaopulver","2 ½ ss sterk kaffe","2 ss margarin eller smør"]}],"instructions":["Pisk egg og sukker til eggedosis.","Rør inn smeltet margarin.","Tilsett havregryn, hvetemel og bakepulver, bland godt.","Vend inn hakkede mandler eller rosiner.","Fordel røren i muffinsformer, ca. ¾ fulle.","Stek ved 175 °C i 15–20 minutter til de er gylne.","Lag glasur: Bland melis og kakao, tilsett kaffe og smeltet margarin. Rør til en glatt glasur.","Avkjøl muffinsene før du smører glasuren på.","TIP: Tilsett gjerne litt hakket mørk sjokolade i røren for ekstra smak."],"createdAt":"2025-08-18"},
            {"id":"recipe_1755561648523_d51yw1y7u","title":"Honningkake","servings":"12 stk.","provider":"Farmor","reference":"Farmors oppskrifter","pageNumber":40,"category":"Kake","meal":"Dessert","cuisine":"Norsk","description":"En klassisk norsk honningkake med krydder og søt glasur. Kaken er saftig, krydret og holder seg godt. Passer til jul eller kaffekos.","image":"honningkake.png","ingredients":[{"group":"Deig","items":["500 g lys sirup (ca. 4 dl)","325 g hvetemel (ca. 5,5 dl)","1 ss smør","50 g sukker (ca. 0,5 dl)","1 ss malt ingefær","1 ts kanel","1 ts kardemomme","1 ts natron","2 egg","1,5 dl kulturmelk eller kefir"]},{"group":"Glasur","items":["200 g margarin","50 g melis (ca. 1 dl)","1 eggehvite","1 ts vaniljesukker eller 1 ss appelsinmarmelade"]}],"instructions":["Varm sirupen i vannbad til den blir flytende.","Rør inn sukker og smør til det smelter. Avkjøl litt.","Bland mel, krydder og natron i en bolle.","Tilsett sirupsblanding og kulturmelk vekselsvis i det tørre.","Visp eggene lett sammen og vend inn i røren.","Hell røren i en smurt form (22–24 cm springform eller liten langpanne).","Stek ved 175 °C i ca. 45–55 minutter, sjekk med kakepinne.","Avkjøl på rist.","Pisk margarin og melis til luftig krem.","Tilsett eggehvite og smak til med vaniljesukker eller appelsinmarmelade.","Bre glasuren over avkjølt kake.","TIP: La kaken hvile til neste dag for best smak. Kan fryses."],"createdAt":"2025-08-19"},
            {"id":"recipe_1755484726501_29ubmpget","title":"Rundstykker","servings":"ca. 16 rundstykker","provider":"Farmor","category":"Brød","meal":"Frokost","cuisine":"Norsk","description":"Klassiske luftige rundstykker som passer perfekt til frokost, lunsj eller kveldsmat. Deigen er enkel å lage, og med både melk og smør får du myke rundstykker med god smak. De er like gode nystekte som oppvarmet, og egner seg også godt til frysing.","image":"rundstykker.png","ingredients":["500 g hvetemel","1 pose tørrgjær (ca. 11 g)","50 g smør (romtemperert eller smeltet)","1 ½ ts salt","2 dl melk (lunken, ca. 37–40 °C)","1 ½ dl vann (lunkent, ca. 37–40 °C)","1 ss sukker"],"instructions":["Bland sammen hvetemel, tørrgjær, salt og sukker i en stor bolle.","Varm melk og vann til ca. 37–40 °C. Ha dette i melblandingen sammen med smøret.","Elt deigen i kjøkkenmaskin i 8–10 minutter (eller 12–15 minutter for hånd) til den er smidig og slipper bollen.","Dekk bollen med plast eller klede og la deigen heve på et lunt sted i ca. 1 time, til den har blitt dobbelt så stor.","Del deigen i ca. 16 emner og trill til runde boller. Legg dem på et stekebrett med bakepapir.","Etterhev rundstykkene i 30–40 minutter under klede.","Forvarm ovnen til 220 °C over-/undervarme. Stek rundstykkene midt i ovnen i 10–12 minutter til de er gylne og gjennomstekte.","Avkjøl på rist før servering."],"createdAt":"2025-08-18"}
        ];

        // User data - automatically saved to localStorage
        let userData = {};

        // Helper function to find recipe by ID
        function findRecipeById(recipeId) {
            return recipeDatabase.find(recipe => recipe.id === recipeId);
        }

        // Load user data from localStorage
        function loadData() {
            const storedUserData = localStorage.getItem('userData');
            if (storedUserData) {
                userData = JSON.parse(storedUserData);
            }
        }

        // Save user data to localStorage
        function saveData() {
            localStorage.setItem('userData', JSON.stringify(userData));
        }

        // Get recipe with user data merged
        function getRecipeWithUserData(recipeId) {
            const recipe = findRecipeById(recipeId);
            if (!recipe) return null;
            
            const userInfo = userData[recipeId] || {
                userRating: null,
                madeDates: [],
                lastViewed: null,
                favorite: false
            };
            return { ...recipe, ...userInfo };
        }

        // Initialize user data for new recipe
        function initializeUserData(recipeId) {
            if (!userData[recipeId]) {
                userData[recipeId] = {
                    userRating: null,
                    madeDates: [],
                    lastViewed: null,
                    viewCount: 0,
                    favorite: false
                };
            }
        }

        // Get unique categories, meals and cuisines from recipes
        function getRecipeFilters() {
            const categories = new Set();
            const meals = new Set();
            const cuisines = new Set();
            
            recipeDatabase.forEach(recipe => {
                if (recipe.category) categories.add(recipe.category);
                if (recipe.meal) meals.add(recipe.meal);
                if (recipe.cuisine) cuisines.add(recipe.cuisine);
            });
            
            return {
                categories: Array.from(categories).sort(),
                meals: Array.from(meals).sort(),
                cuisines: Array.from(cuisines).sort()
            };
        }

        // Format source information
        function formatSource(recipe) {
            let parts = [];
            if (recipe.provider) {
                parts.push(recipe.provider);
            }
            if (recipe.reference) {
                parts.push(recipe.reference);
            }
            if (recipe.pageNumber) {
                parts.push(`s. ${recipe.pageNumber}`);
            }
            return parts.join(' • ');
        }

        // Activate filter by clicking on category/meal/cuisine
        function activateFilter(filterType, filterValue, event) {
            if (event) {
                event.stopPropagation();
            }
            
            const filterKey = `${filterType}:${filterValue}`;
            
            // Close modal if it's open
            const modal = document.getElementById('recipeModal');
            if (!modal.classList.contains('hidden')) {
                closeRecipe();
            }
            
            // Add filter if not already active
            if (!activeFilters.has(filterKey)) {
                activeFilters.set(filterKey, true);
                renderFilterPills();
                updateFilterButton();
                applyFilters();
                renderFilterOptions();
                updateRecommendationsVisibility();
            }
        }

        // Render filter options in dropdown
        function renderFilterOptions() {
            const container = document.getElementById('filterOptions');
            const filters = getRecipeFilters();
            
            container.innerHTML = '';
            
            // Category filters
            if (filters.categories.length > 0) {
                const categoryHeader = document.createElement('div');
                categoryHeader.className = 'text-xs font-semibold text-gray-500 uppercase tracking-wider px-2 pt-1 pb-1';
                categoryHeader.textContent = 'Kategori';
                container.appendChild(categoryHeader);
                
                filters.categories.forEach(category => {
                    const isSelected = activeFilters.has(`category:${category}`);
                    const option = document.createElement('label');
                    option.className = 'flex items-center justify-between p-2 hover:bg-amber-50 rounded-lg cursor-pointer transition-colors';
                    option.innerHTML = `
                        <span class="text-sm text-gray-700">${category}</span>
                        <input type="checkbox" 
                               ${isSelected ? 'checked' : ''} 
                               onchange="toggleFilterType('category:${category}')"
                               onclick="event.stopPropagation()"
                               class="rounded border-gray-300 text-amber-600 focus:ring-amber-500 cursor-pointer">
                    `;
                    container.appendChild(option);
                });
            }
            
            // Meal filters
            if (filters.meals.length > 0) {
                const mealHeader = document.createElement('div');
                mealHeader.className = 'text-xs font-semibold text-gray-500 uppercase tracking-wider px-2 pt-3 pb-1';
                mealHeader.textContent = 'Måltid';
                container.appendChild(mealHeader);
                
                filters.meals.forEach(meal => {
                    const isSelected = activeFilters.has(`meal:${meal}`);
                    const option = document.createElement('label');
                    option.className = 'flex items-center justify-between p-2 hover:bg-amber-50 rounded-lg cursor-pointer transition-colors';
                    option.innerHTML = `
                        <span class="text-sm text-gray-700">${meal}</span>
                        <input type="checkbox" 
                               ${isSelected ? 'checked' : ''} 
                               onchange="toggleFilterType('meal:${meal}')"
                               onclick="event.stopPropagation()"
                               class="rounded border-gray-300 text-amber-600 focus:ring-amber-500 cursor-pointer">
                    `;
                    container.appendChild(option);
                });
            }
            
            // Cuisine filters
            if (filters.cuisines.length > 0) {
                const cuisineHeader = document.createElement('div');
                cuisineHeader.className = 'text-xs font-semibold text-gray-500 uppercase tracking-wider px-2 pt-3 pb-1';
                cuisineHeader.textContent = 'Kjøkken';
                container.appendChild(cuisineHeader);
                
                filters.cuisines.forEach(cuisine => {
                    const isSelected = activeFilters.has(`cuisine:${cuisine}`);
                    const option = document.createElement('label');
                    option.className = 'flex items-center justify-between p-2 hover:bg-amber-50 rounded-lg cursor-pointer transition-colors';
                    option.innerHTML = `
                        <span class="text-sm text-gray-700">${cuisine}</span>
                        <input type="checkbox" 
                               ${isSelected ? 'checked' : ''} 
                               onchange="toggleFilterType('cuisine:${cuisine}')"
                               onclick="event.stopPropagation()"
                               class="rounded border-gray-300 text-amber-600 focus:ring-amber-500 cursor-pointer">
                    `;
                    container.appendChild(option);
                });
            }
        }

        // Check if search or filters are active
        function hasActiveSearchOrFilters() {
            return searchQuery.length > 0 || activeFilters.size > 0;
        }

        // Update recommendations visibility
        function updateRecommendationsVisibility() {
            const recommendationsSection = document.getElementById('recommendationsSection');
            if (hasActiveSearchOrFilters()) {
                recommendationsSection.style.display = 'none';
            } else {
                recommendationsSection.style.display = 'block';
            }
        }

        // Toggle filter type selection
        function toggleFilterType(type) {
            if (activeFilters.has(type)) {
                activeFilters.delete(type);
            } else {
                activeFilters.set(type, true);
            }
            renderFilterPills();
            updateFilterButton();
            applyFilters();
            renderFilterOptions();
            updateRecommendationsVisibility();
        }

        // Render filter pills
        function renderFilterPills() {
            const container = document.getElementById('filterPillsContainer');
            const hasFilters = activeFilters.size > 0;
            
            container.innerHTML = '';
            
            // Hide pills if more than 3 filters
            if (activeFilters.size > 3) {
                container.style.maxWidth = '0';
                container.style.opacity = '0';
            } else {
                container.style.maxWidth = hasFilters ? '100%' : '0';
                container.style.opacity = hasFilters ? '1' : '0';
                
                let pillCount = 0;
                activeFilters.forEach((isActive, filterKey) => {
                    if (pillCount >= 3) return; // Max 3 pills
                    
                    const [filterType, filterValue] = filterKey.split(':');
                    const displayName = filterValue || filterKey;
                    
                    const pill = document.createElement('div');
                    pill.className = `filter-pill flex items-center gap-1 px-3 py-1.5 rounded-full text-sm transition-all shadow-sm ${
                        isActive 
                            ? 'bg-gradient-to-r from-amber-500 to-amber-600 text-white' 
                            : 'bg-gray-200 text-gray-500 opacity-60'
                    }`;
                    pill.innerHTML = `
                        <span class="filter-pill-text cursor-pointer font-medium" onclick="togglePillActive('${filterKey}')">${displayName}</span>
                        <button onclick="removeFilter('${filterKey}')" class="ml-1 hover:opacity-70 flex-shrink-0">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    `;
                    container.appendChild(pill);
                    pillCount++;
                });
            }
            
            // Update clear button visibility
            const clearBtn = document.getElementById('clearFilters');
            if (hasFilters) {
                clearBtn.classList.remove('opacity-0', 'pointer-events-none');
                clearBtn.classList.add('opacity-100');
            } else {
                clearBtn.classList.add('opacity-0', 'pointer-events-none');
                clearBtn.classList.remove('opacity-100');
            }
        }

        // Toggle pill active/inactive state
        function togglePillActive(type) {
            if (activeFilters.has(type)) {
                activeFilters.set(type, !activeFilters.get(type));
                renderFilterPills();
                applyFilters();
            }
        }

        // Remove filter
        function removeFilter(type) {
            activeFilters.delete(type);
            renderFilterPills();
            updateFilterButton();
            applyFilters();
            renderFilterOptions();
            updateRecommendationsVisibility();
        }

        // Update filter button state
        function updateFilterButton() {
            const btn = document.getElementById('filterToggle');
            const count = document.getElementById('filterCount');
            const hasFilters = activeFilters.size > 0;
            
            btn.className = 'flex items-center space-x-2 px-4 py-2 rounded-xl transition-all text-sm font-medium shrink-0 shadow-sm hover:shadow-md';
            
            if (hasFilters) {
                btn.classList.add('bg-gradient-to-r', 'from-amber-500', 'to-amber-600', 'text-white', 'hover:from-amber-600', 'hover:to-amber-700');
                count.textContent = activeFilters.size;
                count.classList.remove('hidden');
                count.classList.add('bg-white/30');
            } else {
                btn.classList.add('bg-white', 'text-gray-700', 'hover:text-amber-600', 'border', 'border-gray-200');
                count.classList.add('hidden');
            }
        }

        // Toggle filter menu
        function toggleFilterMenu() {
            const menu = document.querySelector('#filterMenu > div');
            
            if (!filterMenuOpen) {
                renderFilterOptions();
                menu.classList.remove('hidden');
                filterMenuOpen = true;
            } else {
                menu.classList.add('hidden');
                filterMenuOpen = false;
            }
        }

        // Clear all filters
        function clearAllFilters() {
            activeFilters.clear();
            renderFilterPills();
            updateFilterButton();
            applyFilters();
            renderFilterOptions();
            updateRecommendationsVisibility();
        }

        // Apply both search and type filters
        function applyFilters() {
            let filtered = [...recipeDatabase];  // Start with full array
            
            // Apply filters
            const activeCategoryFilters = [];
            const activeMealFilters = [];
            const activeCuisineFilters = [];
            
            activeFilters.forEach((isActive, filterKey) => {
                if (!isActive) return;
                
                const [filterType, filterValue] = filterKey.split(':');
                if (filterType === 'category') {
                    activeCategoryFilters.push(filterValue);
                } else if (filterType === 'meal') {
                    activeMealFilters.push(filterValue);
                } else if (filterType === 'cuisine') {
                    activeCuisineFilters.push(filterValue);
                }
            });
            
            // Filter by category
            if (activeCategoryFilters.length > 0) {
                filtered = filtered.filter(recipe => 
                    activeCategoryFilters.includes(recipe.category)
                );
            }
            
            // Filter by meal type
            if (activeMealFilters.length > 0) {
                filtered = filtered.filter(recipe => 
                    activeMealFilters.includes(recipe.meal)
                );
            }
            
            // Filter by cuisine type
            if (activeCuisineFilters.length > 0) {
                filtered = filtered.filter(recipe => 
                    activeCuisineFilters.includes(recipe.cuisine)
                );
            }
            
            // Apply search filter
            if (searchQuery) {
                filtered = filtered.filter(recipe => {
                    const titleMatch = recipe.title.toLowerCase().includes(searchQuery);
                    
                    // Handle both grouped and non-grouped ingredient formats
                    let ingredientMatch = false;
                    if (recipe.ingredients) {
                        recipe.ingredients.forEach(item => {
                            if (typeof item === 'string') {
                                if (item.toLowerCase().includes(searchQuery)) {
                                    ingredientMatch = true;
                                }
                            } else if (item.items) {
                                item.items.forEach(ing => {
                                    if (ing.toLowerCase().includes(searchQuery)) {
                                        ingredientMatch = true;
                                    }
                                });
                            }
                        });
                    }
                    
                    return titleMatch || ingredientMatch;
                });
            }
            
            // Extract IDs from filtered recipes
            const filteredIds = filtered.map(recipe => recipe.id);
            renderRecipes(filteredIds);
        }

        // Close filter menu when clicking outside
        document.addEventListener('click', (e) => {
            const menu = document.getElementById('filterMenu');
            const toggle = document.getElementById('filterToggle');
            
            if (filterMenuOpen && 
                !menu.contains(e.target) && 
                !toggle.contains(e.target)) {
                toggleFilterMenu();
            }
        });

        // Render recipes
        function renderRecipes(recipesToRender = null) {
            const grid = document.getElementById('recipeGrid');
            grid.innerHTML = '';
            
            const recipeIds = recipesToRender || recipeDatabase.map(r => r.id);
            
            recipeIds.forEach(recipeId => {
                const recipeData = getRecipeWithUserData(recipeId);
                if (recipeData) {
                    const card = createRecipeCard(recipeData);
                    grid.appendChild(card);
                }
            });
        }

        // Create recipe card
        function createRecipeCard(recipe) {
            const card = document.createElement('div');
            card.className = 'recipe-card bg-white rounded-xl shadow-md overflow-hidden cursor-pointer hover:shadow-xl';
            card.setAttribute('data-recipe-id', recipe.id);
            card.onclick = () => showRecipe(recipe.id);
            
            const imageUrl = recipe.image ? IMAGE_PATH_LIST + recipe.image : `https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800&h=600&fit=crop`;
            const sourceInfo = formatSource(recipe);
            
            card.innerHTML = `
                <div class="h-48 bg-gradient-to-br from-amber-100 to-orange-100 relative overflow-hidden">
                    ${recipe.image ? `<img src="${imageUrl}" alt="${recipe.title}" class="w-full h-full object-cover">` : 
                    `<div class="w-full h-full flex items-center justify-center">
                        <span class="text-6xl opacity-30">🍞</span>
                    </div>`}
                    ${recipe.category ? `<span onclick="activateFilter('category', '${recipe.category}', event)" class="category-badge absolute top-2 right-2 bg-white/90 backdrop-blur text-xs font-medium px-2 py-1 rounded-full text-amber-700">${recipe.category}</span>` : ''}
                </div>
                <div class="p-5">
                    <h3 class="font-display text-xl text-gray-800 ${sourceInfo ? 'mb-0' : 'mb-2'}">${recipe.title}</h3>
                    ${sourceInfo ? `<p class="text-xs text-amber-600 mb-2">${sourceInfo}</p>` : ''}
                    <p class="text-gray-600 text-sm mb-2">${recipe.servings}</p>
                    ${recipe.description ? `<p class="text-gray-500 text-xs mb-3 description-clamp">${recipe.description}</p>` : ''}
                    <div class="flex items-center justify-between">
                        <div class="recipe-stars flex items-center space-x-1">
                            ${renderStars(recipe.userRating || 0)}
                        </div>
                        <div class="flex items-center text-sm text-gray-600">
                            <span class="mr-1">👨‍🍳</span>
                            <span class="recipe-counter">${recipe.madeDates ? recipe.madeDates.length : 0}</span>
                        </div>
                    </div>
                </div>
            `;
            
            return card;
        }

        // Render ingredients (handles both grouped and non-grouped formats)
        function renderIngredients(ingredients) {
            if (!ingredients || ingredients.length === 0) return '';
            
            // Check if ingredients are grouped
            const hasGroups = ingredients.some(item => typeof item === 'object' && item.group);
            
            if (!hasGroups) {
                // Simple list format
                return `
                    <ul class="space-y-2">
                        ${ingredients.map(ing => `
                            <li class="flex items-start">
                                <span class="text-amber-600 mr-2">•</span>
                                <span class="text-gray-700">${ing}</span>
                            </li>
                        `).join('')}
                    </ul>
                `;
            } else {
                // Grouped format
                return ingredients.map((group, index) => {
                    if (typeof group === 'string') {
                        return `
                            <ul class="space-y-2 ${index > 0 ? 'mt-4' : ''}">
                                <li class="flex items-start">
                                    <span class="text-amber-600 mr-2">•</span>
                                    <span class="text-gray-700">${group}</span>
                                </li>
                            </ul>
                        `;
                    }
                    
                    return `
                        <div class="${index > 0 ? 'mt-5' : ''}">
                            <h4 class="font-semibold text-sm text-amber-700 mb-2">${group.group}:</h4>
                            <ul class="space-y-2">
                                ${group.items.map(ing => `
                                    <li class="flex items-start">
                                        <span class="text-amber-600 mr-2">•</span>
                                        <span class="text-gray-700">${ing}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    `;
                }).join('');
            }
        }

        // Render instructions with tips support
        function renderInstructions(instructions, isMobile = false) {
            if (!instructions || instructions.length === 0) return '';
            
            let stepNumber = 1;
            const textSizeClass = isMobile ? 'text-sm' : '';
            
            return `
                <ol class="space-y-3">
                    ${instructions.map((inst) => {
                        // Check if this is a tip
                        if (inst.startsWith('TIP:') || inst.startsWith('TIPS:')) {
                            const tipText = inst.replace(/^TIPS?:\s*/i, '');
                            return `
                                <li class="recipe-tip rounded-lg p-3 ${isMobile ? 'px-3 py-2.5' : 'p-3'}">
                                    <div class="flex items-start">
                                        <span class="text-amber-600 mr-2 flex-shrink-0">
                                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                                                <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                                            </svg>
                                        </span>
                                        <div>
                                            <span class="font-semibold text-amber-700 mr-2 text-sm">Tips:</span>
                                            <span class="text-gray-700 ${textSizeClass}">${tipText}</span>
                                        </div>
                                    </div>
                                </li>
                            `;
                        } else {
                            // Regular numbered instruction
                            const currentStep = stepNumber++;
                            return `
                                <li class="flex items-start">
                                    <span class="font-semibold text-amber-600 mr-3 flex-shrink-0">${currentStep}.</span>
                                    <span class="text-gray-700 ${textSizeClass}">${inst}</span>
                                </li>
                            `;
                        }
                    }).join('')}
                </ol>
            `;
        }

        // Render star rating
        function renderStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<span class="text-amber-400">★</span>';
                } else {
                    stars += '<span class="text-gray-300">★</span>';
                }
            }
            return stars;
        }

        // Clear rating
        function clearRating(recipeId, event) {
            if (event) {
                event.stopPropagation();
            }
            
            if (userData[recipeId]) {
                userData[recipeId].userRating = null;
                saveData();
                
                // Update stars in modal
                const eraserBtn = document.getElementById(`eraser-${recipeId}`);
                if (eraserBtn) {
                    eraserBtn.classList.remove('show');
                    const starsContainer = eraserBtn.nextElementSibling;
                    if (starsContainer) {
                        const stars = starsContainer.querySelectorAll('button');
                        stars.forEach(star => {
                            star.classList.remove('text-amber-400');
                            star.classList.add('text-gray-300');
                        });
                    }
                }
                
                // Update the rating in the grid cards
                updateRecipeCardRating(recipeId, 0);
                
                // Refresh recommendations after clearing rating
                setTimeout(() => getRecommendations(), 100);
            }
        }

        // Check if device is mobile
        function isMobile() {
            return window.innerWidth <= 640;
        }

        // Show recipe modal
        function showRecipe(recipeId) {
            const recipe = getRecipeWithUserData(recipeId);
            if (!recipe) return;
            
            // Update view tracking
            if (!userData[recipeId]) {
                initializeUserData(recipeId);
            }
            userData[recipeId].lastViewed = new Date().toISOString();
            userData[recipeId].viewCount = (userData[recipeId].viewCount || 0) + 1;
            saveData();
            
            const modal = document.getElementById('recipeModal');
            const content = document.getElementById('modalContent');
            
            const imageUrl = recipe.image ? IMAGE_PATH_MODAL + recipe.image : `https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800&h=600&fit=crop`;
            const sourceInfo = formatSource(recipe);
            
            // Check if recipe was made today
            const today = new Date().toISOString().split('T')[0];
            const madeToday = recipe.madeDates && recipe.madeDates.includes(today);
            const madeCount = recipe.madeDates ? recipe.madeDates.length : 0;
            
            // Mobile-specific layout with truly fixed image and close button
            if (isMobile()) {
                content.innerHTML = `
                    <!-- Fixed image container (outside scrollable area) -->
                    <div class="modal-image-container-fixed">
                        <div class="h-full bg-gradient-to-br from-amber-100 to-orange-100 relative">
                            ${recipe.image ? `<img src="${imageUrl}" alt="${recipe.title}" class="w-full h-full object-cover">` : 
                            `<div class="w-full h-full flex items-center justify-center">
                                <span class="text-8xl opacity-30">🍞</span>
                            </div>`}
                            ${recipe.category ? `<span onclick="activateFilter('category', '${recipe.category}', event)" class="category-badge absolute top-4 left-4 bg-white/90 backdrop-blur text-xs font-medium px-2 py-1 rounded-full text-amber-700">${recipe.category}</span>` : ''}
                        </div>
                    </div>
                    
                    <!-- Fixed close button (outside scrollable area) -->
                    <button onclick="closeRecipe()" class="fixed top-4 right-4 z-50 bg-white/90 backdrop-blur rounded-full p-2 hover:bg-white shadow-lg">
                        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                    
                    <!-- Scrollable content only -->
                    <div class="modal-content-scrollable">
                        <div class="modal-content-spacer"></div>
                        <div class="modal-content-body px-4">
                            <div class="pt-4 pb-3">
                                <h2 class="font-display text-2xl text-gray-800 ${sourceInfo ? 'mb-0' : 'mb-1'}">${recipe.title}</h2>
                                ${sourceInfo ? `<p class="text-xs text-amber-600 mb-2">${sourceInfo}</p>` : ''}
                                <p class="text-gray-600 text-sm mb-3">${recipe.servings}</p>
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center gap-2">
                                        <button id="eraser-${recipe.id}" 
                                                onclick="clearRating('${recipe.id}', event)" 
                                                class="eraser-btn text-gray-400 hover:text-gray-600 transition p-1 ${recipe.userRating ? 'show' : ''}">
                                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M15.14 3c.51 0 1 .2 1.36.58l3.92 3.92c.78.78.78 2.04 0 2.82l-9.19 9.19L4 22l2.49-7.23L15.68 5.6c.36-.38.85-.6 1.36-.6m0 2.12L8 12.26V14h1.75l7.14-7.14L15.14 5.12M3 17.25L6.75 21 2 22l1-4.75z"/>
                                            </svg>
                                        </button>
                                        <div class="flex items-center">
                                            ${renderInteractiveStars(recipe)}
                                        </div>
                                    </div>
                                    <button onclick="toggleMadeToday('${recipe.id}', event)" 
                                            class="flex items-center space-x-1 px-3 py-1.5 rounded-lg transition text-xs font-medium
                                                   ${madeToday 
                                                     ? 'bg-amber-600 text-white' 
                                                     : 'border border-gray-300 text-gray-600 hover:bg-gray-50'}">
                                        <svg class="w-4 h-4" fill="${madeToday ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                        <span>Laget (${madeCount})</span>
                                    </button>
                                </div>
                                ${recipe.cuisine || recipe.meal ? `
                                <div class="text-xs text-gray-500">
                                    ${recipe.cuisine ? `<span onclick="activateFilter('cuisine', '${recipe.cuisine}', event)" class="category-badge inline-block px-2 py-0.5 bg-gray-100 rounded-full cursor-pointer hover:bg-amber-100">${recipe.cuisine} kjøkken</span>` : ''}
                                    ${recipe.cuisine && recipe.meal ? ' ' : ''}
                                    ${recipe.meal ? `<span onclick="activateFilter('meal', '${recipe.meal}', event)" class="category-badge inline-block px-2 py-0.5 bg-gray-100 rounded-full cursor-pointer hover:bg-amber-100">${recipe.meal}</span>` : ''}
                                </div>
                                ` : ''}
                            </div>
                            
                            ${recipe.description ? `
                            <div class="pb-4">
                                <p class="text-gray-700 text-sm leading-relaxed">${recipe.description}</p>
                            </div>
                            ` : ''}
                            
                            <div class="space-y-6 pb-12">
                                <div>
                                    <h3 class="font-display text-xl text-amber-800 mb-3">Ingredienser</h3>
                                    ${renderIngredients(recipe.ingredients)}
                                </div>
                                
                                <div>
                                    <h3 class="font-display text-xl text-amber-800 mb-3">Fremgangsmåte</h3>
                                    ${renderInstructions(recipe.instructions, true)}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                // Desktop layout with scroll-over-image effect
                content.innerHTML = `
                    <div class="relative h-full">
                        <!-- Close button absolute to modal container -->
                        <button onclick="closeRecipe()" class="absolute top-4 right-4 z-50 bg-white/90 backdrop-blur rounded-full p-2 hover:bg-white shadow-lg">
                            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                        
                        <div class="flex flex-col h-full overflow-y-auto">
                            <div class="h-[450px] bg-gradient-to-br from-amber-100 to-orange-100 modal-image-fixed flex-shrink-0">
                                ${recipe.image ? `<img src="${imageUrl}" alt="${recipe.title}" class="w-full h-full object-cover">` : 
                                `<div class="w-full h-full flex items-center justify-center">
                                    <span class="text-8xl opacity-30">🍞</span>
                                </div>`}
                                ${recipe.category ? `<span onclick="activateFilter('category', '${recipe.category}', event)" class="category-badge absolute top-4 left-6 bg-white/90 backdrop-blur text-xs font-medium px-2 py-1 rounded-full text-amber-700">${recipe.category}</span>` : ''}
                            </div>
                        <div class="modal-content-overlay">
                            <div class="px-6 pt-5 pb-4 border-b border-gray-100">
                                <h2 class="font-display text-3xl text-gray-800 ${sourceInfo ? 'mb-0' : 'mb-1'}">${recipe.title}</h2>
                                ${sourceInfo ? `<p class="text-xs text-amber-600 mb-2">${sourceInfo}</p>` : ''}
                                <p class="text-gray-600 text-sm mb-3">${recipe.servings}</p>
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <div class="flex items-center gap-2">
                                            <button id="eraser-${recipe.id}" 
                                                    onclick="clearRating('${recipe.id}', event)" 
                                                    class="eraser-btn text-gray-400 hover:text-gray-600 transition p-1 ${recipe.userRating ? 'show' : ''}">
                                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M15.14 3c.51 0 1 .2 1.36.58l3.92 3.92c.78.78.78 2.04 0 2.82l-9.19 9.19L4 22l2.49-7.23L15.68 5.6c.36-.38.85-.6 1.36-.6m0 2.12L8 12.26V14h1.75l7.14-7.14L15.14 5.12M3 17.25L6.75 21 2 22l1-4.75z"/>
                                                </svg>
                                            </button>
                                            <div class="flex items-center">
                                                ${renderInteractiveStars(recipe)}
                                            </div>
                                        </div>
                                        ${recipe.cuisine || recipe.meal ? `
                                        <div class="text-sm text-gray-500">
                                            ${recipe.cuisine ? `<span onclick="activateFilter('cuisine', '${recipe.cuisine}', event)" class="category-badge inline-block px-2 py-0.5 bg-gray-100 rounded-full cursor-pointer hover:bg-amber-100">${recipe.cuisine} kjøkken</span>` : ''}
                                            ${recipe.cuisine && recipe.meal ? ' ' : ''}
                                            ${recipe.meal ? `<span onclick="activateFilter('meal', '${recipe.meal}', event)" class="category-badge inline-block px-2 py-0.5 bg-gray-100 rounded-full cursor-pointer hover:bg-amber-100">${recipe.meal}</span>` : ''}
                                        </div>
                                        ` : ''}
                                    </div>
                                    <button onclick="toggleMadeToday('${recipe.id}', event)" 
                                            class="flex items-center space-x-2 px-3 py-1.5 rounded-lg transition text-sm font-medium
                                                ${madeToday 
                                                    ? 'bg-amber-600 text-white hover:bg-amber-700' 
                                                    : 'border border-gray-300 text-gray-600 hover:bg-gray-50'}">
                                        <svg class="w-5 h-5" fill="${madeToday ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                        <span>Laget (${madeCount})</span>
                                    </button>
                                </div>
                            </div>
                            
                            ${recipe.description ? `
                            <div class="px-6 py-4 bg-amber-50/30">
                                <p class="text-gray-700 leading-relaxed">${recipe.description}</p>
                            </div>
                            ` : ''}
                            
                            <div class="grid md:grid-cols-[2fr,3fr] gap-8 px-8 py-8 pb-16">
                                <div>
                                    <h3 class="font-display text-xl text-amber-800 mb-3">Ingredienser</h3>
                                    ${renderIngredients(recipe.ingredients)}
                                </div>
                                
                                <div>
                                    <h3 class="font-display text-xl text-amber-800 mb-3">Fremgangsmåte</h3>
                                    ${renderInstructions(recipe.instructions, false)}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Lock body scroll
            scrollPosition = window.pageYOffset;
            document.body.classList.add('modal-open');
            document.body.style.top = `-${scrollPosition}px`;
            modal.classList.remove('hidden');
        }

        // Render interactive stars for rating
        function renderInteractiveStars(recipe) {
            let stars = '';
            const userRating = recipe.userRating || 0;
            for (let i = 1; i <= 5; i++) {
                const filled = i <= userRating;
                stars += `<button onclick="rateRecipe('${recipe.id}', ${i}, event)" class="star text-2xl ${filled ? 'text-amber-400' : 'text-gray-300'} hover:text-amber-500">★</button>`;
            }
            return stars;
        }

        // Close recipe modal
        function closeRecipe() {
            document.getElementById('recipeModal').classList.add('hidden');
            // Restore body scroll
            document.body.classList.remove('modal-open');
            document.body.style.top = '';
            window.scrollTo(0, scrollPosition);
        }

        // Rate recipe
        function rateRecipe(recipeId, rating, event) {
            if (event) {
                event.stopPropagation();
            }
            
            if (!userData[recipeId]) {
                initializeUserData(recipeId);
            }
            
            userData[recipeId].userRating = rating;
            saveData();
            
            // Update stars without rebuilding modal
            const button = event ? event.currentTarget : null;
            if (button && button.parentElement) {
                const starsContainer = button.parentElement;
                const stars = starsContainer.querySelectorAll('button');
                stars.forEach((star, index) => {
                    if (index < rating) {
                        star.classList.remove('text-gray-300');
                        star.classList.add('text-amber-400');
                    } else {
                        star.classList.remove('text-amber-400');
                        star.classList.add('text-gray-300');
                    }
                });
                
                // Show eraser button
                const eraserBtn = document.getElementById(`eraser-${recipeId}`);
                if (eraserBtn) {
                    eraserBtn.classList.add('show');
                }
            }
            
            // Update the rating in the grid cards
            updateRecipeCardRating(recipeId, rating);
            
            // Refresh recommendations after rating
            setTimeout(() => getRecommendations(), 100);
        }
        
        // Update recipe card rating in the grid
        function updateRecipeCardRating(recipeId, rating) {
            const cards = document.querySelectorAll(`[data-recipe-id="${recipeId}"]`);
            cards.forEach(card => {
                const starsContainer = card.querySelector('.recipe-stars');
                if (starsContainer) {
                    starsContainer.innerHTML = renderStars(rating);
                }
            });
        }

        // Toggle made today
        function toggleMadeToday(recipeId, event) {
            if (event) {
                event.stopPropagation();
            }
            
            if (!userData[recipeId]) {
                initializeUserData(recipeId);
            }
            
            const today = new Date().toISOString().split('T')[0];
            const madeDates = userData[recipeId].madeDates || [];
            
            const todayIndex = madeDates.indexOf(today);
            if (todayIndex > -1) {
                madeDates.splice(todayIndex, 1);
            } else {
                madeDates.push(today);
            }
            
            userData[recipeId].madeDates = madeDates;
            saveData();
            
            // Update button appearance without rebuilding modal
            const madeToday = madeDates.includes(today);
            const madeCount = madeDates.length;
            const button = event ? event.currentTarget : document.querySelector(`button[onclick*="toggleMadeToday('${recipeId}'"]`);
            
            if (button) {
                // Update button classes
                if (isMobile()) {
                    button.className = `flex items-center space-x-1 px-3 py-1.5 rounded-lg transition text-xs font-medium ${
                        madeToday 
                            ? 'bg-amber-600 text-white' 
                            : 'border border-gray-300 text-gray-600 hover:bg-gray-50'
                    }`;
                } else {
                    button.className = `flex items-center space-x-2 px-3 py-1.5 rounded-lg transition text-sm font-medium ${
                        madeToday 
                            ? 'bg-amber-600 text-white hover:bg-amber-700' 
                            : 'border border-gray-300 text-gray-600 hover:bg-gray-50'
                    }`;
                }
                
                // Update button content
                button.innerHTML = `
                    <svg class="${isMobile() ? 'w-4 h-4' : 'w-5 h-5'}" fill="${madeToday ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <span>Laget (${madeCount})</span>
                `;
            }
            
            // Update the cooked counter in the grid
            updateRecipeCardCounter(recipeId, madeCount);
            
            // Refresh recommendations
            setTimeout(() => getRecommendations(), 100);
        }
        
        // Update recipe card counter in the grid
        function updateRecipeCardCounter(recipeId, count) {
            const cards = document.querySelectorAll(`[data-recipe-id="${recipeId}"]`);
            cards.forEach(card => {
                const counterElement = card.querySelector('.recipe-counter');
                if (counterElement) {
                    counterElement.textContent = count;
                }
            });
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchQuery = e.target.value.toLowerCase();
            applyFilters();
            updateRecommendationsVisibility();
        });

        // Get recommendations
        function getRecommendations() {
            const recommended = document.getElementById('recommendedRecipes');
            
            let recs = [];
            const recipeIds = recipeDatabase.map(r => r.id);
            
            const threeDaysAgo = new Date();
            threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);
            
            // Recently viewed but not in the last 3 days
            const oldViewed = recipeIds.filter(id => {
                const lastViewed = userData[id]?.lastViewed;
                if (!lastViewed) return false;
                const viewedDate = new Date(lastViewed);
                return viewedDate < threeDaysAgo;
            }).slice(0, 2);
            
            // Never viewed
            const neverViewed = recipeIds.filter(id => !userData[id]?.lastViewed).slice(0, 2);
            
            // Highly rated
            const highRated = recipeIds
                .filter(id => (userData[id]?.userRating || 0) > 3)
                .sort((a, b) => (userData[b]?.userRating || 0) - (userData[a]?.userRating || 0))
                .slice(0, 2);
            
            // Combine recommendations (unique)
            const recIdSet = new Set();
            [...oldViewed, ...neverViewed, ...highRated].forEach(id => {
                if (!recIdSet.has(id) && recs.length < 3) {
                    recIdSet.add(id);
                    recs.push(id);
                }
            });
            
            // If we don't have 3 recommendations, add random ones
            while (recs.length < 3 && recs.length < recipeIds.length) {
                const randomId = recipeIds[Math.floor(Math.random() * recipeIds.length)];
                if (!recIdSet.has(randomId)) {
                    recIdSet.add(randomId);
                    recs.push(randomId);
                }
            }
            
            recommended.innerHTML = '';
            recs.forEach(recipeId => {
                const recipeData = getRecipeWithUserData(recipeId);
                if (recipeData) {
                    const card = createRecipeCard(recipeData);
                    recommended.appendChild(card);
                }
            });
        }

        // Close modal on outside click
        document.getElementById('recipeModal').addEventListener('click', (e) => {
            const modalContent = document.querySelector('#recipeModal > div > div');
            if (!modalContent.contains(e.target)) {
                closeRecipe();
            }
        });

        // Initialize
        loadData();
        updateFilterButton();
        renderRecipes();
        getRecommendations();
        updateRecommendationsVisibility();
    </script>
</body>
</html>